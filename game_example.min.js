if(b4w.module_check("example2_main"))throw"Failed to register module: example2_main";
b4w.register("example2_main",function(ca,e){function K(){}function L(){}function M(){}function N(){}function O(){}function P(){}function da(a,g){if(g){Q.create_preloader();var b=I.get_std_assets_path()+"tutorials/making_a_game_p4/game_example.json";ea.load(b,fa,ga)}else console.log("b4w init failure")}function ga(a){Q.update_preloader(a+1)}function fa(){k=c.get_object_by_name("character");c.get_object_by_dupli_name("character","character_collider");m=c.get_object_by_dupli_name("character","character_rig");
poscontrol=c.get_object_by_name("poscontrol");S=c.get_object_by_name("camtarget");_cam_target_2=c.get_object_by_name("camtarget2");_cam_target_3=c.get_object_by_name("camtarget3");var b=a.create_custom_sensor(0),g=a.create_custom_sensor(0),R=a.create_custom_sensor(0),e=a.create_custom_sensor(0),h=a.create_custom_sensor(0);T()&&ha(b,R,g,e,h);ia(R,e);ja(b,g);ka(h);la();U(0);r.id="left_div_id";r.style.position="relative";r.style.width="50%";r.style.cssFloat="left";r.style.color="#00ba0f";r.style.fontSize=
"30px";r.style.fontFamily="sans-serif";r.style.fontWeight="900";document.body.appendChild(r);q.id="left_div2_id";q.style.position="relative";q.style.width="50%";q.style.cssFloat="left";q.style.color="#42f4ee";q.style.fontSize="30px";q.style.fontFamily="sans-serif";q.style.fontWeight="900";document.body.appendChild(q);t.id="left_div3_id";t.style.position="relative";t.style.width="50%";t.style.cssFloat="left";t.style.color="#04ff00";t.style.fontSize="30px";t.style.fontFamily="sans-serif";t.style.fontWeight=
"900";document.body.appendChild(t);u.id="left_div4_id";u.style.position="relative";u.style.width="50%";u.style.cssFloat="left";u.style.color="#ffe900";u.style.fontSize="30px";u.style.fontFamily="sans-serif";u.style.fontWeight="900";document.body.appendChild(u);v.id="left_div5_id";v.style.position="relative";v.style.width="50%";v.style.cssFloat="left";v.style.color="#ff6a00";v.style.fontSize="30px";v.style.fontFamily="sans-serif";v.style.fontWeight="900";document.body.appendChild(v);w.id="left_div6_id";
w.style.position="relative";w.style.width="50%";w.style.cssFloat="left";w.style.color="#ff0000";w.style.fontSize="30px";w.style.fontFamily="sans-serif";w.style.fontWeight="900";document.body.appendChild(w);b=c.get_object_by_name("boat");f.move_local(b,0,0,.1);c.get_object_by_name("Cone");ma[0]=.1;b=c.get_object_by_name("GameReference");a.create_sensor_manifold(b,"MAIN",a.CT_CONTINUOUS,[V],null,na);b=oa.get_canvas();b.addEventListener("mousedown",W,!1);b.addEventListener("touchstart",W,!1)}function W(a){if(document.a&&
null!==document.a||!document.mozFullScreen&&!document.webkitIsFullScreen)document.documentElement.a?document.documentElement.a():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT);a.preventDefault&&a.preventDefault();var b=X.get_coords_x(a);a=X.get_coords_y(a);(b=z.pick_object(b,a))&&"boat"==c.get_object_name(b)&&(null==l?(l=b,
b=Y=c.get_object_by_name("boatattach"),f.get_translation(k,D),f.set_translation(b,D[0],D[1],D[2]),A.append_stiff(k,Y)):(l=null,f.get_translation(k,pa),A.remove(k,!1)))}function qa(a,g){var b=a[2];.8>b&&(b=.8,g[2]=b);1>b&&(b+=.001);g[2]=b}function ra(a,g){g[0]=.2;g[1]=-.2}function sa(a,g){g[0]=2;g[1]=-2}function ta(){}function K(){E.append_custom_callback("alter_ocean_node",ta)}function L(){E.append_custom_callback("alter_ocean_node",ra)}function M(){E.append_custom_callback("alter_ocean_node",sa)}
function N(){E.append_custom_callback("alter_ocean_node",qa)}function O(){var a=c.get_object_by_name("land col.001");f.move_local(a,1,0,0)}function P(){var a=c.get_object_by_name("land col.001");f.move_local(a,-1,0,0)}function na(){var a=ua.get_timeline();x=a-Z;Z=a;f.move_local(k,0,.1*F*x*16,0);a=c.get_object_by_name("dummy");obj=k;f.get_translation(obj,n);y.copy(n,B);y.copy(n,va);n[2]+=1;B[2]-=10;wa.append_ray_test_ext(null,n,B,"ANY",xa,!0,!1,!0,!1);f.get_translation(a,B);f.get_translation(obj,n);
aa?J=0:1<=J||(J+=1);aa=0;null!=l&&f.move_local(l,0,G*x*5,0);if(null!=k){var g=c.get_object_by_name("oceanflat"),a=c.get_object_by_name("ocean"),e=c.get_object_by_name("nearestterrain");temp1_pos=f.get_translation(k);temp2_pos=f.get_translation(e);temp1_pos[2]=0;temp2_pos[2]=0;d=y.distance(temp1_pos,temp2_pos);160>d?(z.hide_object(a,void 0),z.show_object(g,void 0)):(z.show_object(a,void 0),z.hide_object(g,void 0));f.move_local(a,0,-.05*x,0);f.move_local(a,-.05*x,0,0);char_pos=f.get_translation(k);
ocean_pos=f.get_translation(a);g=char_pos[0]-ocean_pos[0];e=char_pos[1]-ocean_pos[1];-100>e&&f.move_local(a,0,-100,0);100<e&&f.move_local(a,0,100,0);-100>g&&f.move_local(a,-100,0,0);100<g&&f.move_local(a,100,0,0)}}function xa(a,g,e,h,l){f.get_translation(k,n);f.set_translation(k,n[0],n[1],l[2]);ba[2]=l[2];a=c.get_object_by_name("dummy");z.hide_object(a,void 0);f.set_translation(a,n[0],n[1],ba[2])}function ia(b,g){function f(a,g,b){if(null==l){if(1==b)switch(g){case "FORWARD":F=-1;p.apply(m,"character_run_B4W_BAKED");
break;case "BACKWARD":F=1,p.apply(m,"character_run_B4W_BAKED")}else F=0,p.apply(m,"character_idle_01_B4W_BAKED");p.play(m);p.set_behavior(m,p.AB_CYCLIC)}else if(1==b)switch(g){case "FORWARD":G=1;break;case "BACKWARD":G=-1}else G=0}function e(a,g,b){if(1==b)switch(g){case "MW_FORWARD":H+=1,3<H&&(H=0),U(H)}}var c=a.create_keyboard_sensor(a.KEY_W),h=a.create_keyboard_sensor(a.KEY_S),n=a.create_keyboard_sensor(a.KEY_UP),ya=a.create_keyboard_sensor(a.KEY_DOWN),C=a.create_mouse_wheel_sensor();a.create_keyboard_sensor(a.KEY_O);
var za=a.create_keyboard_sensor(a.KEY_P),Aa=a.create_keyboard_sensor(a.KEY_L),c=[c,n,b,h,ya,g],C=[C,za,b,C,Aa,g];a.create_sensor_manifold(k,"FORWARD",a.CT_TRIGGER,c,function(a){return a[0]||a[1]||a[2]},f);a.create_sensor_manifold(k,"BACKWARD",a.CT_TRIGGER,c,function(a){return a[3]||a[4]||a[5]},f);a.create_sensor_manifold(k,"MW_FORWARD",a.CT_TRIGGER,C,function(a){return a[0]||a[1]||a[2]},e);a.create_sensor_manifold(k,"MW_BACKWARD",a.CT_TRIGGER,C,function(a){return a[3]||a[4]||a[5]},e);p.apply(m,"character_idle_01_B4W_BAKED");
p.play(m);p.set_behavior(m,p.AB_CYCLIC)}function ja(b,g){function e(g,b,e){var c=a.get_sensor_value(g,"LEFT",6);if(null==l){if(1==e)switch(b){case "LEFT":f.rotate_z_local(g,6*x*.6);break;case "RIGHT":f.rotate_z_local(g,6*x*-.6)}}else if(1==e)switch(b){case "LEFT":rot=f.get_rotation_euler(l);f.set_rotation_euler(l,rot[0],rot[1],rot[2]+6*c);break;case "RIGHT":rot=f.get_rotation_euler(l),f.set_rotation_euler(l,rot[0],rot[1],rot[2]-6*c)}}var c=a.create_keyboard_sensor(a.KEY_A),h=a.create_keyboard_sensor(a.KEY_D),
n=a.create_keyboard_sensor(a.KEY_LEFT),p=a.create_keyboard_sensor(a.KEY_RIGHT),c=[c,n,g,h,p,b,V];a.create_sensor_manifold(k,"LEFT",a.CT_CONTINUOUS,c,function(a){return a[0]||a[1]||a[2]},e);a.create_sensor_manifold(k,"RIGHT",a.CT_CONTINUOUS,c,function(a){return a[3]||a[4]||a[5]},e)}function ka(b){var g=a.create_keyboard_sensor(a.KEY_SPACE);a.create_sensor_manifold(k,"JUMP",a.CT_SHOT,[g,b],function(a){return a[0]||a[1]},function(){})}function la(){var b=a.create_keyboard_sensor(a.KEY_1);a.create_sensor_manifold(null,
"KEY1",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){K()});b=a.create_keyboard_sensor(a.KEY_2);a.create_sensor_manifold(null,"KEY2",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){L()});b=a.create_keyboard_sensor(a.KEY_3);a.create_sensor_manifold(null,"KEY3",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){M()});b=a.create_keyboard_sensor(a.KEY_4);a.create_sensor_manifold(null,"KEY4",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){N()});b=a.create_keyboard_sensor(a.KEY_5);
a.create_sensor_manifold(null,"KEY5",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){O()});b=a.create_keyboard_sensor(a.KEY_6);a.create_sensor_manifold(null,"KEY6",a.CT_SHOT,[b],function(a){return a[0]||a[1]},function(){P()})}function ha(b,g,e,c,f){function h(h){h.preventDefault();h=h.changedTouches;for(var k=0;k<h.length;k++)h[k].identifier==n?(a.set_custom_sensor(g,0),a.set_custom_sensor(c,0),a.set_custom_sensor(e,0),a.set_custom_sensor(b,0),p.style.visibility="hidden",m.style.visibility=
"hidden",n=null):h[k].identifier==l&&(a.set_custom_sensor(f,0),l=null)}var k=new Float32Array(2),n,l,p=document.getElementById("control_tap"),m=document.getElementById("control_circle"),r=p.clientWidth/2,q=m.clientWidth/2;document.getElementById("canvas3d").addEventListener("touchstart",function(a){a.preventDefault();var b=window.innerWidth;a=a.changedTouches;for(var g=0;g<a.length;g++){var e=a[g],c=e.clientX,f=e.clientY;if(c>b/2)break;k[0]=c;k[1]=f;n=e.identifier;p.style.visibility="visible";p.style.left=
c-r+"px";p.style.top=f-r+"px";m.style.visibility="visible";m.style.left=c-q+"px";m.style.top=f-q+"px"}},!1);document.getElementById("control_jump").addEventListener("touchstart",toggleFullScreen(document.body),!1);document.getElementById("canvas3d").addEventListener("touchmove",function(f){f.preventDefault();a.set_custom_sensor(g,0);a.set_custom_sensor(c,0);a.set_custom_sensor(e,0);a.set_custom_sensor(b,0);var h=window.innerWidth;f=f.changedTouches;for(var n=0;n<f.length;n++){var l=f[n],m=l.clientX,
l=l.clientY;if(m>h/2)break;p.style.left=m-r+"px";p.style.top=l-r+"px";var m=m-k[0],l=l-k[1],q=Math.sqrt(m*m+l*l);if(16>q)break;m/=q;l=-l/q;m>Math.cos(3*Math.PI/8)?a.set_custom_sensor(b,1):m<-Math.cos(3*Math.PI/8)&&a.set_custom_sensor(e,1);l>Math.sin(Math.PI/8)?a.set_custom_sensor(g,1):l<-Math.sin(Math.PI/8)&&a.set_custom_sensor(c,1)}},!1);document.getElementById("canvas3d").addEventListener("touchend",h,!1);document.getElementById("controls").addEventListener("touchend",h,!1);document.getElementById("delete").addEventListener("delete",
toggleFullScreen,!1)}function T(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i)?!0:!1}function U(a){if(0==a){h[0]=0;h[1]=4;h[2]=1.5;var b=c.get_active_camera();A.append_semi_soft(b,k,h,.2)}1==a&&(h[0]=0,h[1]=55,h[2]=-3,b=c.get_active_camera(),A.append_semi_soft(b,S,h,
.2));2==a&&(h[0]=0,h[1]=18,h[2]=-7,b=c.get_active_camera(),A.append_semi_soft(b,_cam_target_2,h,0));3==a&&(h[0]=0,h[1]=2,h[2]=-2,b=c.get_active_camera(),A.append_semi_soft(b,_cam_target_3,h,0))}var oa=e("container"),p=e("animation"),Ba=e("app"),I=e("config"),ea=e("data"),a=e("controls"),wa=e("physics"),A=e("constraints"),c=e("scenes"),z=c,y=e("vec3"),va=y.create(),f=e("transform"),Ca=e("quat");e("objects");var X=e("mouse");e("tsr");var Q=e("preloader");e("debug");var ua=e("time"),E=e("logic_nodes"),
ba=y.create(),aa=0,D=new Float32Array(3),B=new Float32Array(3),n=new Float32Array(3),Z=0,x=0,V=a.create_elapsed_sensor(),r=document.createElement("div"),q=document.createElement("div"),t=document.createElement("div"),u=document.createElement("div"),v=document.createElement("div"),w=document.createElement("div"),k=null,m=null,S=null,h=new Float32Array([0,4,1.5]),H=0,F=0,l,Y,G=0,pa=y.create();y.create();Ca.create();var J=0,ma=new Float32Array(999);ca.init=function(){Ba.init({canvas_container_id:"canvas3d",
callback:da,physics_enabled:!0,quality:T()?I.P_LOW:I.P_HIGH,show_fps:!0,autoresize:!0,alpha:!1})}});b4w.require("example2_main").init();
